<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./reset.css">
  <link rel="icon" type="image/png" sizes="32x32" href="./images/favicon-32x32.png">
  <link rel="stylesheet" href="./style.css">
  <title>Todo app</title>
</head>
<body class="bg-very-light-gray">
  <div class="header">
    <h1 class="text-very-light-gray">Todo</h1>
    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="26" height="26"><path fill="#FFF" fill-rule="evenodd" d="M13 0c.81 0 1.603.074 2.373.216C10.593 1.199 7 5.43 7 10.5 7 16.299 11.701 21 17.5 21c2.996 0 5.7-1.255 7.613-3.268C23.22 22.572 18.51 26 13 26 5.82 26 0 20.18 0 13S5.82 0 13 0z"/></svg>
  </div>
  <form class="input-section bg-white">
    <div class="circle-container">
      <div class="circle"></div>
    </div>
    <input class="text-font-style-task text-light-grayish-blue" type="text" name="add-task" id="add-task" placeholder="Create new todo...">
  </form>
  <ul class="bg-white" id="tasks">
  </ul>
  <div class="info bg-white">
    <span class="text-font-style-task text-light-grayish-blue" id="active-left">5 items left</span>
    <a class="text-font-style-task text-light-grayish-blue" href="#" id="delete-completed">Clear Completed</a>
  </div>
  <div class="filter-container bg-white" id="filter-buttons">
    <a class="text-font-style-filter text-light-grayish-blue" href="#" data-filter="all">All</a>
    <a class="text-font-style-filter text-light-grayish-blue" href="#" data-filter="active">Active</a>
    <a class="text-font-style-filter text-light-grayish-blue" href="#" data-filter="completed">Completed</a>
  </div>
  <span class="drop-and-drag-info text-font-style-task text-light-grayish-blue">Drag and drop to reorder list</span>


<script src="./lib.js"></script>
<script src="./data.js"></script>
<script>

setup (tasks, "tasks");


let input = document.getElementById("add-task");

input.onkeydown = (e) => {
  if (e.keyCode === 13) {
    e.preventDefault();
    tasks.unshift({
      name: input.value,
      active: true,
    })
    setup (tasks, "tasks");
  }
};

let deleteAllCompleted = document.getElementById("delete-completed");

deleteAllCompleted.addEventListener("click", (event)=>{
  let task = Array.from(document.getElementsByClassName("task-completed"));
  task.map((el)=>{
    let taskDataId = el.getAttribute("data-id");
    console.log(taskDataId);
    tasks.splice(taskDataId,1);
    setup (tasks, "tasks");
  });
});

let filterContainer = document.getElementById("filter-buttons");

filterContainer.addEventListener("click", (event)=>{
  event.preventDefault();
  const filter = event.target.getAttribute("data-filter");

  switch (filter) {
    case "active": 
      tasks.map((task)=>{
        let taskElementCompleted = document.getElementsByClassName(`task-completed`);
        let taskElementNotCompleted = document.getElementsByClassName(`task-not-completed`);

        if (task.active){
          for (let i =0; i<taskElementCompleted.length; i++) {
          let task = taskElementCompleted[i]
          task.classList.add("hidden");
          }
        }else{
          for (let i =0; i<taskElementNotCompleted.length; i++) {
          let task = taskElementNotCompleted[i]
          task.classList.remove("hidden");
          }
        }
      });
      break;
    case "completed": 
      tasks.map((task)=>{
        let taskElementCompleted = document.getElementsByClassName(`task-completed`);
        let taskElementNotCompleted = document.getElementsByClassName(`task-not-completed`);
        if (task.active){
          for (let i =0; i<taskElementCompleted.length; i++) {
          let task = taskElementCompleted[i]
          task.classList.remove("hidden");
          }
        }else{
          for (let i =0; i<taskElementNotCompleted.length; i++) {
          let task = taskElementNotCompleted[i]
          task.classList.add("hidden");
          }
        }
      });
      break;
    case "all":
      tasks.map((task)=>{
        let taskElement = document.getElementsByClassName(`task`);
        for (let i =0; i<taskElement.length; i++) {
        let task = taskElement[i]
        task.classList.remove("hidden");
        }
      });
      break;
  }
});

</script>


</body>
</html>